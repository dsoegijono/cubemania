<div id="times">
  <div id="chart">
    <a href="http://www.adobe.com/go/getflashplayer">
      <img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="Get Adobe Flash player" />
    </a>
  </div>
  <div id="slider"><div class="ui-slider-handle"></div></div>
  <%= select_tag 'puzzle', options_for_puzzle_select, :onchange => 'addSeries(this)' %>
</div>

<%- content_for :head, javascript_tag("swfobject.embedSWF('/movies/chart.swf', 'chart', '750', '400', '9.0.28.0', '/movies/expressInstall.swf', {dataUrl: '#{@records.map { |r| formatted_kind_puzzle_averages_path r.puzzle.kind, r.puzzle, :xml, :user_id => @user.id }.join(';')}'}, {wmode: 'transparent'});") -%>
<%- javascript_tag do -%>
  function addSeries(select) {
    var index = select.selectedIndex;
    if (index > 0) {
      document.getElementById("chart").addSeries(select.options[index].value);
      select.selectedIndex = 0;
    }
  }
  function setSliderMax(max) {
    $('#slider').slider('updateMax', max);
  }
  $('#slider').slider({min: 1, max: 1, startValue: 1, stepping: 1, change: function(e, ui) {
    try { document.getElementById("chart").setItemCount(ui.value) } catch (e) {}
  }});
<%- end -%>